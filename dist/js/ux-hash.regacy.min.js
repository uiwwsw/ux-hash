"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var UxHash=function(){function n(e,t){_classCallCheck(this,n),this.id=Math.random().toString(36).substr(2,9),this.querySelector=e,this.keys=t.map(function(e){return e.key}),this.colors=t.map(function(e){return e.color}),this.bgs=t.map(function(e){return e.bg}),this.wrapperElement=document.querySelector(this.querySelector),this.textareaElement=document.createElement("textarea"),this.displayElement=document.createElement("div"),this.makeStyle(),this.wrapperElement.appendChild(this.textareaElement),this.wrapperElement.appendChild(this.displayElement),this.displayElement.style.right=this.textareaElement.scrollWidth-this.textareaElement.clientWidth+"px",this.textareaElement.onkeyup=this.keyEvent.bind(this),this.textareaElement.onscroll=this.scrollEvent.bind(this)}return _createClass(n,[{key:"makeStyle",value:function(){var e="overflow: auto;overflow-x: hidden;display: block !important;height: 100%;margin: 0;padding: 1em;box-sizing: border-box;border: 0;line-height: inherit;word-spacing: inherit;color: inherit;font: inherit;resize: none;outline: none;word-break: initial;white-space: pre-wrap;";this.wrapperElement.style.position="relative",this.wrapperElement.style.fontSize="12px",this.textareaElement.setAttribute("style",e+"width: 100%;"),this.displayElement.setAttribute("style",e+"z-index:2;position: absolute;top: 0;right: 0;left: 0;overflow: hidden;color: transparent;pointer-events: none;")}},{key:"scrollEvent",value:function(){this.displayElement.scrollTop=this.textareaElement.scrollTop,this.textareaElement.scrollTop=this.displayElement.scrollTop}},{key:"mask",value:function(){var r=this,i="";return this.textareaElement.value.split("\n").forEach(function(e,t){i+=0===t?"":"\n",e.split(" ").forEach(function(e,t){i+=0===t?"":" ";var n=r.keys.indexOf(e[0]);i+=-1===n?e:'<span style="margin: -.1em;padding: 0 .1em;border-radius: 1em;color:'.concat(r.colors[n],";background:").concat(r.bgs[n],';">').concat(e,"</span>")})}),i+"\n\n"}},{key:"keyEvent",value:function(){this.displayElement.innerHTML=this.mask(),this.scrollEvent()}}],[{key:"keyEvent",value:function(e,t){var n=document.querySelector(e),r=n.querySelector("textarea"),i=n.querySelector("div"),a=(n.className,n.querySelector("textarea").value),o=t.map(function(e){return e.key}),l=t.map(function(e){return e.color}),s=t.map(function(e){return e.bg}),c="";a.split("\n").forEach(function(e,t){c+=0===t?"":"\n",e.split(" ").forEach(function(e,t){c+=0===t?"":" ";var n=o.indexOf(e[0]);c+=-1===n?e:'<span style="margin: -.1em;padding: 0 .1em;border-radius: 1em;color:'.concat(l[n],";background:").concat(s[n],';">').concat(e,"</span>")})}),i.scrollTop=r.scrollTop,r.scrollTop=i.scrollTop,i.innerHTML=c+"\n\n"}}]),n}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIiwiaW5kZXgudHMiXSwibmFtZXMiOlsiVXhIYXNoIiwicXVlcnlTZWxlY3RvciIsInRoZW1lcyIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJpZCIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0ciIsImtleXMiLCJtYXAiLCJ0aGVtZSIsImtleSIsImNvbG9ycyIsImNvbG9yIiwiYmdzIiwiYmciLCJ3cmFwcGVyRWxlbWVudCIsImRvY3VtZW50IiwidGV4dGFyZWFFbGVtZW50IiwiY3JlYXRlRWxlbWVudCIsImRpc3BsYXlFbGVtZW50IiwibWFrZVN0eWxlIiwiYXBwZW5kQ2hpbGQiLCJzdHlsZSIsInJpZ2h0Iiwic2Nyb2xsV2lkdGgiLCJjbGllbnRXaWR0aCIsIm9ua2V5dXAiLCJrZXlFdmVudCIsImJpbmQiLCJvbnNjcm9sbCIsInNjcm9sbEV2ZW50IiwiY29tbW9uU3R5bGUiLCJwb3NpdGlvbiIsImZvbnRTaXplIiwic2V0QXR0cmlidXRlIiwic2Nyb2xsVG9wIiwiX3RoaXMiLCJyZXMiLCJ2YWx1ZSIsInNwbGl0IiwiZm9yRWFjaCIsImxpbmUiLCJpIiwid29yZCIsImoiLCJpbmRleCIsImluZGV4T2YiLCJjb25jYXQiLCJpbm5lckhUTUwiLCJtYXNrIiwiY2xhc3NOYW1lIl0sIm1hcHBpbmdzIjoiQUFBQSx1WkNBTUEsa0JBU0YsU0FBQUEsRUFBWUMsRUFBdUJDLEdBQWVDLGdCQUFBQyxLQUFBSixHQUM5Q0ksS0FBS0MsR0FBS0MsS0FBS0MsU0FBU0MsU0FBUyxJQUFJQyxPQUFPLEVBQUcsR0FDL0NMLEtBQUtILGNBQWdCQSxFQUNyQkcsS0FBS00sS0FBT1IsRUFBT1MsSUFBSSxTQUFDQyxHQUFELE9BQWtCQSxFQUFNQyxNQUMvQ1QsS0FBS1UsT0FBU1osRUFBT1MsSUFBSSxTQUFDQyxHQUFELE9BQWtCQSxFQUFNRyxRQUNqRFgsS0FBS1ksSUFBTWQsRUFBT1MsSUFBSSxTQUFDQyxHQUFELE9BQWtCQSxFQUFNSyxLQUM5Q2IsS0FBS2MsZUFBaUJDLFNBQVNsQixjQUFjRyxLQUFLSCxlQUNsREcsS0FBS2dCLGdCQUFrQkQsU0FBU0UsY0FBYyxZQUM5Q2pCLEtBQUtrQixlQUFpQkgsU0FBU0UsY0FBYyxPQUM3Q2pCLEtBQUttQixZQUNMbkIsS0FBS2MsZUFBZU0sWUFBWXBCLEtBQUtnQixpQkFDckNoQixLQUFLYyxlQUFlTSxZQUFZcEIsS0FBS2tCLGdCQUNyQ2xCLEtBQUtrQixlQUFlRyxNQUFNQyxNQUFRdEIsS0FBS2dCLGdCQUFnQk8sWUFBY3ZCLEtBQUtnQixnQkFBZ0JRLFlBQWMsS0FDeEd4QixLQUFLZ0IsZ0JBQWdCUyxRQUFVekIsS0FBSzBCLFNBQVNDLEtBQUszQixNQUNsREEsS0FBS2dCLGdCQUFnQlksU0FBVzVCLEtBQUs2QixZQUFZRixLQUFLM0IsK0RBSXRELElBQU04QixFQUFjLGlSQUNwQjlCLEtBQUtjLGVBQWVPLE1BQU1VLFNBQVcsV0FDckMvQixLQUFLYyxlQUFlTyxNQUFNVyxTQUFXLE9BQ3JDaEMsS0FBS2dCLGdCQUFnQmlCLGFBQWEsUUFBU0gsRUFBYyxnQkFDekQ5QixLQUFLa0IsZUFBZWUsYUFBYSxRQUFTSCxFQUFjLHdKQUl4RDlCLEtBQUtrQixlQUFlZ0IsVUFBWWxDLEtBQUtnQixnQkFBZ0JrQixVQUNyRGxDLEtBQUtnQixnQkFBZ0JrQixVQUFZbEMsS0FBS2tCLGVBQWVnQix5Q0E4QnJELElBQUFDLEVBQUFuQyxLQUNJb0MsRUFBTSxHQWFWLE9BWkFwQyxLQUFLZ0IsZ0JBQWdCcUIsTUFBTUMsTUFBTSxNQUFNQyxRQUFRLFNBQUNDLEVBQWNDLEdBQzFETCxHQUFjLElBQU5LLEVBQVUsR0FBSyxLQUN2QkQsRUFBS0YsTUFBTSxLQUFLQyxRQUFRLFNBQUNHLEVBQWNDLEdBQ25DUCxHQUFjLElBQU5PLEVBQVUsR0FBSyxJQUN2QixJQUFNQyxFQUFRVCxFQUFLN0IsS0FBS3VDLFFBQVFILEVBQUssSUFFakNOLElBRFcsSUFBWFEsRUFDT0YsRUFFSix1RUFBQUksT0FBMkVYLEVBQUt6QixPQUFPa0MsR0FBdkYsZ0JBQUFFLE9BQTRHWCxFQUFLdkIsSUFBSWdDLEdBQXJILE9BQUFFLE9BQWlJSixFQUFqSSxlQUlSTixFQUFNLDBDQUlicEMsS0FBS2tCLGVBQWU2QixVQUFZL0MsS0FBS2dELE9BQ3JDaEQsS0FBSzZCLGlEQTlDT2hDLEVBQXVCQyxHQUNuQyxJQUFNZ0IsRUFBaUJDLFNBQVNsQixjQUFjQSxHQUN4Q21CLEVBQWtCRixFQUFlakIsY0FBYyxZQUMvQ3FCLEVBQWlCSixFQUFlakIsY0FBYyxPQUU5Q3dDLEdBREt2QixFQUFlbUMsVUFDWm5DLEVBQWVqQixjQUFjLFlBQWF3QyxPQUNsRC9CLEVBQU9SLEVBQU9TLElBQUksU0FBQ0MsR0FBRCxPQUFrQkEsRUFBTUMsTUFDMUNDLEVBQVNaLEVBQU9TLElBQUksU0FBQ0MsR0FBRCxPQUFrQkEsRUFBTUcsUUFDNUNDLEVBQU1kLEVBQU9TLElBQUksU0FBQ0MsR0FBRCxPQUFrQkEsRUFBTUssS0FDM0N1QixFQUFNLEdBQ1ZDLEVBQU1DLE1BQU0sTUFBTUMsUUFBUSxTQUFDQyxFQUFjQyxHQUNyQ0wsR0FBYyxJQUFOSyxFQUFVLEdBQUssS0FDdkJELEVBQUtGLE1BQU0sS0FBS0MsUUFBUSxTQUFDRyxFQUFjQyxHQUNuQ1AsR0FBYyxJQUFOTyxFQUFVLEdBQUssSUFDdkIsSUFBTUMsRUFBUXRDLEVBQUt1QyxRQUFRSCxFQUFLLElBRTVCTixJQURXLElBQVhRLEVBQ09GLEVBRUosdUVBQUFJLE9BQTJFcEMsRUFBT2tDLEdBQWxGLGdCQUFBRSxPQUF1R2xDLEVBQUlnQyxHQUEzRyxPQUFBRSxPQUF1SEosRUFBdkgsZUFJZnhCLEVBQWVnQixVQUFZbEIsRUFBZ0JrQixVQUMzQ2xCLEVBQWdCa0IsVUFBWWhCLEVBQWVnQixVQUMzQ2hCLEVBQWU2QixVQUFZWCxFQUFNIiwiZmlsZSI6ImpzL3V4LWhhc2gucmVnYWN5Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuY2xhc3MgVXhIYXNoIHtcbiAgICBjb25zdHJ1Y3RvcihxdWVyeVNlbGVjdG9yLCB0aGVtZXMpIHtcbiAgICAgICAgdGhpcy5pZCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KTtcbiAgICAgICAgdGhpcy5xdWVyeVNlbGVjdG9yID0gcXVlcnlTZWxlY3RvcjtcbiAgICAgICAgdGhpcy5rZXlzID0gdGhlbWVzLm1hcCgodGhlbWUpID0+IHRoZW1lLmtleSk7XG4gICAgICAgIHRoaXMuY29sb3JzID0gdGhlbWVzLm1hcCgodGhlbWUpID0+IHRoZW1lLmNvbG9yKTtcbiAgICAgICAgdGhpcy5iZ3MgPSB0aGVtZXMubWFwKCh0aGVtZSkgPT4gdGhlbWUuYmcpO1xuICAgICAgICB0aGlzLndyYXBwZXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLnF1ZXJ5U2VsZWN0b3IpO1xuICAgICAgICB0aGlzLnRleHRhcmVhRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJyk7XG4gICAgICAgIHRoaXMuZGlzcGxheUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGhpcy5tYWtlU3R5bGUoKTtcbiAgICAgICAgdGhpcy53cmFwcGVyRWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLnRleHRhcmVhRWxlbWVudCk7XG4gICAgICAgIHRoaXMud3JhcHBlckVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5kaXNwbGF5RWxlbWVudCk7XG4gICAgICAgIHRoaXMuZGlzcGxheUVsZW1lbnQuc3R5bGUucmlnaHQgPSB0aGlzLnRleHRhcmVhRWxlbWVudC5zY3JvbGxXaWR0aCAtIHRoaXMudGV4dGFyZWFFbGVtZW50LmNsaWVudFdpZHRoICsgJ3B4JztcbiAgICAgICAgdGhpcy50ZXh0YXJlYUVsZW1lbnQub25rZXl1cCA9IHRoaXMua2V5RXZlbnQuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy50ZXh0YXJlYUVsZW1lbnQub25zY3JvbGwgPSB0aGlzLnNjcm9sbEV2ZW50LmJpbmQodGhpcyk7XG4gICAgfVxuICAgIG1ha2VTdHlsZSgpIHtcbiAgICAgICAgY29uc3QgY29tbW9uU3R5bGUgPSAnb3ZlcmZsb3c6IGF1dG87b3ZlcmZsb3cteDogaGlkZGVuO2Rpc3BsYXk6IGJsb2NrICFpbXBvcnRhbnQ7aGVpZ2h0OiAxMDAlO21hcmdpbjogMDtwYWRkaW5nOiAxZW07Ym94LXNpemluZzogYm9yZGVyLWJveDtib3JkZXI6IDA7bGluZS1oZWlnaHQ6IGluaGVyaXQ7d29yZC1zcGFjaW5nOiBpbmhlcml0O2NvbG9yOiBpbmhlcml0O2ZvbnQ6IGluaGVyaXQ7cmVzaXplOiBub25lO291dGxpbmU6IG5vbmU7d29yZC1icmVhazogaW5pdGlhbDt3aGl0ZS1zcGFjZTogcHJlLXdyYXA7JztcbiAgICAgICAgdGhpcy53cmFwcGVyRWxlbWVudC5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XG4gICAgICAgIHRoaXMud3JhcHBlckVsZW1lbnQuc3R5bGUuZm9udFNpemUgPSAnMTJweCc7XG4gICAgICAgIHRoaXMudGV4dGFyZWFFbGVtZW50LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBjb21tb25TdHlsZSArICd3aWR0aDogMTAwJTsnKTtcbiAgICAgICAgdGhpcy5kaXNwbGF5RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgY29tbW9uU3R5bGUgKyAnei1pbmRleDoyO3Bvc2l0aW9uOiBhYnNvbHV0ZTt0b3A6IDA7cmlnaHQ6IDA7bGVmdDogMDtvdmVyZmxvdzogaGlkZGVuO2NvbG9yOiB0cmFuc3BhcmVudDtwb2ludGVyLWV2ZW50czogbm9uZTsnKTtcbiAgICB9XG4gICAgc2Nyb2xsRXZlbnQoKSB7XG4gICAgICAgIHRoaXMuZGlzcGxheUVsZW1lbnQuc2Nyb2xsVG9wID0gdGhpcy50ZXh0YXJlYUVsZW1lbnQuc2Nyb2xsVG9wO1xuICAgICAgICB0aGlzLnRleHRhcmVhRWxlbWVudC5zY3JvbGxUb3AgPSB0aGlzLmRpc3BsYXlFbGVtZW50LnNjcm9sbFRvcDtcbiAgICB9XG4gICAgc3RhdGljIGtleUV2ZW50KHF1ZXJ5U2VsZWN0b3IsIHRoZW1lcykge1xuICAgICAgICBjb25zdCB3cmFwcGVyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocXVlcnlTZWxlY3Rvcik7XG4gICAgICAgIGNvbnN0IHRleHRhcmVhRWxlbWVudCA9IHdyYXBwZXJFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3RleHRhcmVhJyk7XG4gICAgICAgIGNvbnN0IGRpc3BsYXlFbGVtZW50ID0gd3JhcHBlckVsZW1lbnQucXVlcnlTZWxlY3RvcignZGl2Jyk7XG4gICAgICAgIGNvbnN0IGlkID0gd3JhcHBlckVsZW1lbnQuY2xhc3NOYW1lO1xuICAgICAgICBjb25zdCB2YWx1ZSA9IHdyYXBwZXJFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3RleHRhcmVhJykudmFsdWU7XG4gICAgICAgIGNvbnN0IGtleXMgPSB0aGVtZXMubWFwKCh0aGVtZSkgPT4gdGhlbWUua2V5KTtcbiAgICAgICAgY29uc3QgY29sb3JzID0gdGhlbWVzLm1hcCgodGhlbWUpID0+IHRoZW1lLmNvbG9yKTtcbiAgICAgICAgY29uc3QgYmdzID0gdGhlbWVzLm1hcCgodGhlbWUpID0+IHRoZW1lLmJnKTtcbiAgICAgICAgbGV0IHJlcyA9ICcnO1xuICAgICAgICB2YWx1ZS5zcGxpdCgnXFxuJykuZm9yRWFjaCgobGluZSwgaSkgPT4ge1xuICAgICAgICAgICAgcmVzICs9IChpID09PSAwID8gJycgOiAnXFxuJyk7XG4gICAgICAgICAgICBsaW5lLnNwbGl0KCcgJykuZm9yRWFjaCgod29yZCwgaikgPT4ge1xuICAgICAgICAgICAgICAgIHJlcyArPSAoaiA9PT0gMCA/ICcnIDogJyAnKTtcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IGtleXMuaW5kZXhPZih3b3JkWzBdKTtcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlcyArPSB3b3JkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzICs9IGA8c3BhbiBzdHlsZT1cIm1hcmdpbjogLS4xZW07cGFkZGluZzogMCAuMWVtO2JvcmRlci1yYWRpdXM6IDFlbTtjb2xvcjoke2NvbG9yc1tpbmRleF19O2JhY2tncm91bmQ6JHtiZ3NbaW5kZXhdfTtcIj4ke3dvcmR9PC9zcGFuPmA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBkaXNwbGF5RWxlbWVudC5zY3JvbGxUb3AgPSB0ZXh0YXJlYUVsZW1lbnQuc2Nyb2xsVG9wO1xuICAgICAgICB0ZXh0YXJlYUVsZW1lbnQuc2Nyb2xsVG9wID0gZGlzcGxheUVsZW1lbnQuc2Nyb2xsVG9wO1xuICAgICAgICBkaXNwbGF5RWxlbWVudC5pbm5lckhUTUwgPSByZXMgKyAnXFxuXFxuJztcbiAgICB9XG4gICAgbWFzaygpIHtcbiAgICAgICAgbGV0IHJlcyA9ICcnO1xuICAgICAgICB0aGlzLnRleHRhcmVhRWxlbWVudC52YWx1ZS5zcGxpdCgnXFxuJykuZm9yRWFjaCgobGluZSwgaSkgPT4ge1xuICAgICAgICAgICAgcmVzICs9IChpID09PSAwID8gJycgOiAnXFxuJyk7XG4gICAgICAgICAgICBsaW5lLnNwbGl0KCcgJykuZm9yRWFjaCgod29yZCwgaikgPT4ge1xuICAgICAgICAgICAgICAgIHJlcyArPSAoaiA9PT0gMCA/ICcnIDogJyAnKTtcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMua2V5cy5pbmRleE9mKHdvcmRbMF0pO1xuICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzICs9IHdvcmQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXMgKz0gYDxzcGFuIHN0eWxlPVwibWFyZ2luOiAtLjFlbTtwYWRkaW5nOiAwIC4xZW07Ym9yZGVyLXJhZGl1czogMWVtO2NvbG9yOiR7dGhpcy5jb2xvcnNbaW5kZXhdfTtiYWNrZ3JvdW5kOiR7dGhpcy5iZ3NbaW5kZXhdfTtcIj4ke3dvcmR9PC9zcGFuPmA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzICsgJ1xcblxcbic7XG4gICAgfVxuICAgIGtleUV2ZW50KCkge1xuICAgICAgICB0aGlzLmRpc3BsYXlFbGVtZW50LmlubmVySFRNTCA9IHRoaXMubWFzaygpO1xuICAgICAgICB0aGlzLnNjcm9sbEV2ZW50KCk7XG4gICAgfVxufVxuIiwiY2xhc3MgVXhIYXNoIHtcbiAgICBwcml2YXRlIGlkOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBxdWVyeVNlbGVjdG9yOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSB3cmFwcGVyRWxlbWVudDogSFRNTERpdkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSB0ZXh0YXJlYUVsZW1lbnQ6IEhUTUxUZXh0QXJlYUVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBkaXNwbGF5RWxlbWVudDogSFRNTERpdkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBrZXlzOiBzdHJpbmdbXTtcbiAgICBwcml2YXRlIGNvbG9yczogc3RyaW5nW107XG4gICAgcHJpdmF0ZSBiZ3M6IHN0cmluZ1tdO1xuICAgIGNvbnN0cnVjdG9yKHF1ZXJ5U2VsZWN0b3I6IHN0cmluZywgdGhlbWVzOiBUaGVtZVtdKSB7XG4gICAgICAgIHRoaXMuaWQgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSk7XG4gICAgICAgIHRoaXMucXVlcnlTZWxlY3RvciA9IHF1ZXJ5U2VsZWN0b3I7XG4gICAgICAgIHRoaXMua2V5cyA9IHRoZW1lcy5tYXAoKHRoZW1lOiBUaGVtZSkgPT4gdGhlbWUua2V5KTtcbiAgICAgICAgdGhpcy5jb2xvcnMgPSB0aGVtZXMubWFwKCh0aGVtZTogVGhlbWUpID0+IHRoZW1lLmNvbG9yKTtcbiAgICAgICAgdGhpcy5iZ3MgPSB0aGVtZXMubWFwKCh0aGVtZTogVGhlbWUpID0+IHRoZW1lLmJnKTtcbiAgICAgICAgdGhpcy53cmFwcGVyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5xdWVyeVNlbGVjdG9yKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgdGhpcy50ZXh0YXJlYUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpO1xuICAgICAgICB0aGlzLmRpc3BsYXlFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRoaXMubWFrZVN0eWxlKCk7XG4gICAgICAgIHRoaXMud3JhcHBlckVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy50ZXh0YXJlYUVsZW1lbnQpO1xuICAgICAgICB0aGlzLndyYXBwZXJFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuZGlzcGxheUVsZW1lbnQpO1xuICAgICAgICB0aGlzLmRpc3BsYXlFbGVtZW50LnN0eWxlLnJpZ2h0ID0gdGhpcy50ZXh0YXJlYUVsZW1lbnQuc2Nyb2xsV2lkdGggLSB0aGlzLnRleHRhcmVhRWxlbWVudC5jbGllbnRXaWR0aCArICdweCc7XG4gICAgICAgIHRoaXMudGV4dGFyZWFFbGVtZW50Lm9ua2V5dXAgPSB0aGlzLmtleUV2ZW50LmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMudGV4dGFyZWFFbGVtZW50Lm9uc2Nyb2xsID0gdGhpcy5zY3JvbGxFdmVudC5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIG1ha2VTdHlsZSgpIHtcbiAgICAgICAgY29uc3QgY29tbW9uU3R5bGUgPSAnb3ZlcmZsb3c6IGF1dG87b3ZlcmZsb3cteDogaGlkZGVuO2Rpc3BsYXk6IGJsb2NrICFpbXBvcnRhbnQ7aGVpZ2h0OiAxMDAlO21hcmdpbjogMDtwYWRkaW5nOiAxZW07Ym94LXNpemluZzogYm9yZGVyLWJveDtib3JkZXI6IDA7bGluZS1oZWlnaHQ6IGluaGVyaXQ7d29yZC1zcGFjaW5nOiBpbmhlcml0O2NvbG9yOiBpbmhlcml0O2ZvbnQ6IGluaGVyaXQ7cmVzaXplOiBub25lO291dGxpbmU6IG5vbmU7d29yZC1icmVhazogaW5pdGlhbDt3aGl0ZS1zcGFjZTogcHJlLXdyYXA7J1xuICAgICAgICB0aGlzLndyYXBwZXJFbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcbiAgICAgICAgdGhpcy53cmFwcGVyRWxlbWVudC5zdHlsZS5mb250U2l6ZSA9ICcxMnB4JztcbiAgICAgICAgdGhpcy50ZXh0YXJlYUVsZW1lbnQuc2V0QXR0cmlidXRlKCdzdHlsZScsIGNvbW1vblN0eWxlICsgJ3dpZHRoOiAxMDAlOycpO1xuICAgICAgICB0aGlzLmRpc3BsYXlFbGVtZW50LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBjb21tb25TdHlsZSArICd6LWluZGV4OjI7cG9zaXRpb246IGFic29sdXRlO3RvcDogMDtyaWdodDogMDtsZWZ0OiAwO292ZXJmbG93OiBoaWRkZW47Y29sb3I6IHRyYW5zcGFyZW50O3BvaW50ZXItZXZlbnRzOiBub25lOycgKTtcbiAgICB9XG5cbiAgICBzY3JvbGxFdmVudCgpIHtcbiAgICAgICAgdGhpcy5kaXNwbGF5RWxlbWVudC5zY3JvbGxUb3AgPSB0aGlzLnRleHRhcmVhRWxlbWVudC5zY3JvbGxUb3A7XG4gICAgICAgIHRoaXMudGV4dGFyZWFFbGVtZW50LnNjcm9sbFRvcCA9IHRoaXMuZGlzcGxheUVsZW1lbnQuc2Nyb2xsVG9wO1xuICAgIH1cblxuICAgIHN0YXRpYyBrZXlFdmVudChxdWVyeVNlbGVjdG9yOiBzdHJpbmcsIHRoZW1lczogVGhlbWVbXSkge1xuICAgICAgICBjb25zdCB3cmFwcGVyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocXVlcnlTZWxlY3RvcikgYXMgSFRNTERpdkVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IHRleHRhcmVhRWxlbWVudCA9IHdyYXBwZXJFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3RleHRhcmVhJykgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcbiAgICAgICAgY29uc3QgZGlzcGxheUVsZW1lbnQgPSB3cmFwcGVyRWxlbWVudC5xdWVyeVNlbGVjdG9yKCdkaXYnKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgY29uc3QgaWQgPSB3cmFwcGVyRWxlbWVudC5jbGFzc05hbWU7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gd3JhcHBlckVsZW1lbnQucXVlcnlTZWxlY3RvcigndGV4dGFyZWEnKSEudmFsdWU7XG4gICAgICAgIGNvbnN0IGtleXMgPSB0aGVtZXMubWFwKCh0aGVtZTogVGhlbWUpID0+IHRoZW1lLmtleSk7XG4gICAgICAgIGNvbnN0IGNvbG9ycyA9IHRoZW1lcy5tYXAoKHRoZW1lOiBUaGVtZSkgPT4gdGhlbWUuY29sb3IpO1xuICAgICAgICBjb25zdCBiZ3MgPSB0aGVtZXMubWFwKCh0aGVtZTogVGhlbWUpID0+IHRoZW1lLmJnKTtcbiAgICAgICAgbGV0IHJlcyA9ICcnO1xuICAgICAgICB2YWx1ZS5zcGxpdCgnXFxuJykuZm9yRWFjaCgobGluZTogc3RyaW5nLCBpOiBudW1iZXIpID0+IHtcbiAgICAgICAgICAgIHJlcyArPSAoaSA9PT0gMCA/ICcnIDogJ1xcbicpO1xuICAgICAgICAgICAgbGluZS5zcGxpdCgnICcpLmZvckVhY2goKHdvcmQ6IHN0cmluZywgajogbnVtYmVyKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVzICs9IChqID09PSAwID8gJycgOiAnICcpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0ga2V5cy5pbmRleE9mKHdvcmRbMF0pO1xuICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzICs9IHdvcmQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzICs9IGA8c3BhbiBzdHlsZT1cIm1hcmdpbjogLS4xZW07cGFkZGluZzogMCAuMWVtO2JvcmRlci1yYWRpdXM6IDFlbTtjb2xvcjoke2NvbG9yc1tpbmRleF19O2JhY2tncm91bmQ6JHtiZ3NbaW5kZXhdfTtcIj4ke3dvcmR9PC9zcGFuPmBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGRpc3BsYXlFbGVtZW50LnNjcm9sbFRvcCA9IHRleHRhcmVhRWxlbWVudC5zY3JvbGxUb3A7XG4gICAgICAgIHRleHRhcmVhRWxlbWVudC5zY3JvbGxUb3AgPSBkaXNwbGF5RWxlbWVudC5zY3JvbGxUb3A7XG4gICAgICAgIGRpc3BsYXlFbGVtZW50LmlubmVySFRNTCA9IHJlcyArICdcXG5cXG4nO1xuICAgIH1cblxuICAgIG1hc2soKSB7XG4gICAgICAgIGxldCByZXMgPSAnJztcbiAgICAgICAgdGhpcy50ZXh0YXJlYUVsZW1lbnQudmFsdWUuc3BsaXQoJ1xcbicpLmZvckVhY2goKGxpbmU6IHN0cmluZywgaTogbnVtYmVyKSA9PiB7XG4gICAgICAgICAgICByZXMgKz0gKGkgPT09IDAgPyAnJyA6ICdcXG4nKTtcbiAgICAgICAgICAgIGxpbmUuc3BsaXQoJyAnKS5mb3JFYWNoKCh3b3JkOiBzdHJpbmcsIGo6IG51bWJlcikgPT4ge1xuICAgICAgICAgICAgICAgIHJlcyArPSAoaiA9PT0gMCA/ICcnIDogJyAnKTtcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMua2V5cy5pbmRleE9mKHdvcmRbMF0pO1xuICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzICs9IHdvcmQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzICs9IGA8c3BhbiBzdHlsZT1cIm1hcmdpbjogLS4xZW07cGFkZGluZzogMCAuMWVtO2JvcmRlci1yYWRpdXM6IDFlbTtjb2xvcjoke3RoaXMuY29sb3JzW2luZGV4XX07YmFja2dyb3VuZDoke3RoaXMuYmdzW2luZGV4XX07XCI+JHt3b3JkfTwvc3Bhbj5gXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzICsgJ1xcblxcbic7XG4gICAgfVxuXG4gICAga2V5RXZlbnQoKSB7XG4gICAgICAgIHRoaXMuZGlzcGxheUVsZW1lbnQuaW5uZXJIVE1MID0gdGhpcy5tYXNrKCk7XG4gICAgICAgIHRoaXMuc2Nyb2xsRXZlbnQoKTtcbiAgICB9XG59XG50eXBlIFRoZW1lID0ge1xuICAgIGJnOnN0cmluZyxcbiAgICBjb2xvcjpzdHJpbmcsXG4gICAga2V5OnN0cmluZ1xufSJdfQ==
